{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }} | Shop Details{% endblock %}

{% block main %}

<div class="breadcrumb-area">
    <div class="top-breadcrumb-area bg-img bg-overlay d-flex align-items-center justify-content-center" style="background-image: url({% static 'img/bg-img/24.jpg' %});">
        <h2>Shop Details</h2>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'index' %}"><i class="fa fa-home"></i> Home</a></li>
                        <li class="breadcrumb-item"><a href="{% url 'shop' %}">Shop</a></li>
                        <li class="breadcrumb-item active" aria-current="page">{{ product.name }}</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>
<section class="single_product_details_area mb-50">
    <div class="produts-details--content mb-50">
        <div class="container">
            <div class="row justify-content-between">

                <div class="col-12 col-md-6 col-lg-5">
                    <div class="product-gallery">
                        <div class="main-image-container">
                            <img id="main-product-image" 
                                 src="{% if product_images %}{{ product_images.0.image.url }}{% else %}{% static 'img/no-image.png' %}{% endif %}" 
                                 alt="Main product image">
                        </div>
                        <div class="thumbnail-container d-flex mt-2">
                            {% for image in product_images %}
                                <div class="thumbnail-item">
                                    <img class="thumbnail-image" src="{{ image.image.url }}" alt="Product thumbnail {{ forloop.counter }}">
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="col-12 col-md-6">
                    <div class="single_product_desc">
                        <h4 class="title">{{ product.name }}</h4>
                        <h4 class="price">â‚¹{{ product.price|floatformat:2 }}</h4>
                        <div class="short_overview">
                            <p>{{ product.description|linebreaks }}</p>
                        </div>

                        <div class="cart--area d-flex flex-wrap align-items-center">
                            <form class="cart clearfix d-flex align-items-center" method="post" action="{% url 'add_to_cart' product.id %}">
                                {% csrf_token %}
                                <div class="quantity">
                                    <span class="qty-minus" onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN(qty) && qty > 1 ) effect.value--;return false;"><i class="fa fa-minus" aria-hidden="true"></i></span>
                                    <input type="number" class="qty-text" id="qty" step="1" min="1" max="10" name="quantity" value="1">
                                    <span class="qty-plus" onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN(qty)) effect.value++;return false;"><i class="fa fa-plus" aria-hidden="true"></i></span>
                                </div>
                                <button type="submit" name="addtocart" class="btn alazea-btn ml-15">Add to cart</button>
                            </form>
                        </div>
                        <div class="products--meta">
                            <p><span>Category:</span> {{ product.category.name }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    </section>
<style>
    .main-image-container {
        border: 1px solid #ebebeb;
        border-radius: 5px;
        overflow: hidden;
    }
    #main-product-image {
        width: 100%;
        height: auto;
        max-height: 500px;
        object-fit: cover;
    }
    .thumbnail-container {
        gap: 10px; /* Space between thumbnails */
    }
    .thumbnail-item {
        width: 80px;
        height: 80px;
        border: 1px solid #ddd;
        border-radius: 5px;
        overflow: hidden;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s ease, border-color 0.2s ease;
    }
    .thumbnail-item:hover,
    .thumbnail-item.active {
        opacity: 1;
        border-color: #70c745; /* Your theme's green color */
    }
    .thumbnail-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const mainImage = document.getElementById('main-product-image');
    const thumbnails = document.querySelectorAll('.thumbnail-image');
    const thumbnailItems = document.querySelectorAll('.thumbnail-item');

    // Set the first thumbnail as active by default
    if (thumbnailItems.length > 0) {
        thumbnailItems[0].classList.add('active');
    }

    thumbnails.forEach((thumbnail, index) => {
        thumbnail.addEventListener('click', function() {
            // Change the main image src to the clicked thumbnail's src
            mainImage.src = this.src;

            // Update the active state for the border
            thumbnailItems.forEach(item => item.classList.remove('active'));
            thumbnailItems[index].classList.add('active');
        });
    });
});
</script>

{% endblock %}